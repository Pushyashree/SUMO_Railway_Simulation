
# SUMO Railway Simulation Workflow

This README provides a step-by-step workflow for setting up and running a railway simulation using **SUMO** (Simulation of Urban MObility). The scenario involves simulating trains running between **three main stations** and **intermediate stations**, with two different types of routes: 
- Trains that **stop at all stations**.
- Trains that **skip some stations**.

The workflow involves creating and configuring several files, including `.net`, `.add`, `.trip`, `.rou`, and `.cfg` files.

## 1. Creating the Network File (`.net.xml`)

### **Using NETEDIT to Create Nodes and Edges**
The railway network can be created using **NETEDIT**, a graphical editor for SUMO networks. NETEDIT allows users to:
- Add **nodes** representing junctions or stations.
- Add **edges** representing railway tracks between the nodes.

#### **Steps to Create a Network in NETEDIT**
1. Open NETEDIT.
2. Add **nodes** at the desired locations for stations and junctions.
3. Connect nodes by adding **edges** to form railway tracks.
4. Save the network file as `.net.xml`.

For more details, refer to the official SUMO NETEDIT documentation: [NETEDIT Documentation](https://sumo.dlr.de/docs/NETEDIT.html).

### **Defining Rail Signals in NETEDIT**
In a railway network, junctions can act as **block sections** controlled by rail signals.

#### **Procedure to Define Rail Signals**
1. Select a node in NETEDIT.
2. Set the node type to **rail signal**. This can also be done manually by editing the `.net.xml` file and adding the attribute `junction="rail_signal"` to the relevant node.

For more information on defining rail signals, refer to: [Rail Signals Documentation](https://sumo.dlr.de/docs/NETEDIT.html#rail_signals).

---

## 2. Creating the Additional File (`.add.xml`)

The `.add.xml` file contains **rail stops** defined as bus stops in SUMO. Rail stops are added to specify where trains will stop at stations.

### **Steps to Define Rail Stops in NETEDIT**
1. Select the desired edge where the rail stop should be placed.
2. Add a **bus stop** by specifying its length and position on the edge.
3. Save the additional file as `.add.xml`.

For detailed instructions on adding stops using NETEDIT, refer to: [Adding Stops Documentation](https://sumo.dlr.de/docs/NETEDIT.html#bus_stops).

---

## 3. Creating the Trip File (`.trip.xml`)

The `.trip.xml` file defines the trips (train journeys) in the network. Each trip includes:
- The route that the train follows.
- Departure times.
- Stopping times at each station.

### **Manual Creation of Trips**
1. Define two different routes:
   - **Route 1**: Covers all stations.
   - **Route 2**: Skips some intermediate stations.
2. Create trips for each train with:
   - A **20-minute headway** between consecutive train departures.
   - A **stopping time of 30 seconds** at each stop.
   - A total simulation duration of **8 hours**.

For more detailed workflows on creating trips, refer to: [SUMO Trip Definition](https://sumo.dlr.de/docs/Simulation/Trips.html).

---

## 4. Generating the Route File (`.rou.xml`)

The `.rou.xml` file specifies the exact routes taken by the trips. This file is generated by combining the `.net.xml` and `.trip.xml` files using **DUAROUTER**.

### **Using DUAROUTER**
DUAROUTER is a tool that converts trips into routes based on the network topology.

#### **Command to Generate the Route File**
```bash
duarouter -n network.net.xml -t trips.trip.xml -o routes.rou.xml
```
- `-n`: Specifies the input network file.
- `-t`: Specifies the input trip file.
- `-o`: Specifies the output route file.

Additional DUAROUTER options and commands can be found here: [DUAROUTER Documentation](https://sumo.dlr.de/docs/duarouter.html).

---

## 5. Creating the Configuration File (`.cfg`)

The `.cfg` file specifies the overall configuration for running the simulation. It includes references to all the required input files and simulation parameters.

### **Basic Structure of the Configuration File**
```xml
<configuration>
    <input>
        <net-file value="network.net.xml"/>
        <route-files value="routes.rou.xml"/>
        <additional-files value="stops.add.xml"/>
    </input>
    <time>
        <begin value="0"/>
        <end value="28800"/><!-- 8 hours = 28800 seconds -->
    </time>
    <output>
        <tripinfo-output value="tripinfo.xml"/>
    </output>
</configuration>
```
- **`<net-file>`**: Specifies the network file.
- **`<route-files>`**: Specifies the route file.
- **`<additional-files>`**: Specifies additional files like rail stops.
- **`<begin>` and `<end>`**: Define the start and end time of the simulation.
- **`<tripinfo-output>`**: Specifies the output file to store trip information.

For more details on configuration files, refer to: [SUMO Configuration Documentation](https://sumo.dlr.de/docs/Simulation/Configuration.html).

---

## 6. Running the Simulation

To run the simulation, use the following command:
```bash
sumo -c simulation.cfg
```
Or, to run it with a graphical interface:
```bash
sumo-gui -c simulation.cfg
```

---

## 7. Output Files

SUMO generates several output files based on the configuration. Common outputs include:
- **`tripinfo.xml`**: Contains detailed information about each trip, including departure time, arrival time, and travel duration.

For a comprehensive list of output files and their formats, refer to: [SUMO Output Documentation](https://sumo.dlr.de/docs/Simulation/Output/index.html).

---

## Summary
This README covers the entire workflow for setting up and running a railway simulation in SUMO, including:
1. Creating the network and defining rail signals.
2. Adding rail stops.
3. Defining trips and generating routes.
4. Creating the configuration file.
5. Running the simulation and analyzing outputs.

For further details, please refer to the linked official SUMO documentation.

Happy Simulating!
